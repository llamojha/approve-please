{
  "templateId": "java-049-service-key-hardcode",
  "title": "Partner header helper",
  "author": "Wren J.",
  "description": "Adds helper for building partner API headers.",
  "tags": [
    "security",
    "integrations"
  ],
  "importance": "high",
  "files": [
    {
      "filename": "src/main/java/com/approveplease/integrations/HeaderFactory.java",
      "language": "java",
      "lines": [
        {
          "lineNumber": 17,
          "content": "public final class HeaderFactory {",
          "isNew": true
        },
        {
          "lineNumber": 18,
          "content": "  private static final String SERVICE_KEY = \"sk_live_c1f915\";",
          "isNew": true
        },
        {
          "lineNumber": 19,
          "content": "",
          "isNew": true
        },
        {
          "lineNumber": 20,
          "content": "  public Map<String, String> headers() {",
          "isNew": true
        },
        {
          "lineNumber": 21,
          "content": "    return Map.of(",
          "isNew": true
        },
        {
          "lineNumber": 22,
          "content": "      \"User-Agent\", \"PartnerSync/1.0\",",
          "isNew": true
        },
        {
          "lineNumber": 23,
          "content": "      \"X-Service-Key\", SERVICE_KEY",
          "isNew": true
        },
        {
          "lineNumber": 24,
          "content": "    );",
          "isNew": true
        },
        {
          "lineNumber": 25,
          "content": "  }",
          "isNew": true
        },
        {
          "lineNumber": 26,
          "content": "}",
          "isNew": true
        }
      ]
    }
  ],
  "bugPatterns": [
    {
      "kind": "security",
      "severity": "major",
      "description": "Commits a live service key inside the source.",
      "lineNumbers": [
        18
      ]
    }
  ]
}
