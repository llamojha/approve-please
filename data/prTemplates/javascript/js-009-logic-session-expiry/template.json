{
  "templateId": "js-009-logic-session-expiry",
  "title": "Session expiry enforcement",
  "author": "Malik C.",
  "description": "Refresh tokens should not extend sessions beyond 30 days.",
  "tags": [
    "security",
    "auth"
  ],
  "localized": {
    "es": {
      "title": "Aplicaci\u00f3n del vencimiento de sesi\u00f3n",
      "description": "Los refresh tokens no deben extender sesiones m\u00e1s all\u00e1 de 30 d\u00edas.",
      "tags": [
        "seguridad",
        "auth"
      ]
    }
  },
  "files": [
    {
      "filename": "src/auth/session.js",
      "language": "javascript",
      "lines": [
        {
          "lineNumber": 27,
          "content": "  if (session.age > MAX_SESSION_DAYS) {",
          "isNew": true
        },
        {
          "lineNumber": 28,
          "content": "    session.terminatedAt = new Date();",
          "isNew": true
        },
        {
          "lineNumber": 29,
          "content": "  }",
          "isNew": true
        }
      ]
    }
  ],
  "bugPatterns": [
    {
      "kind": "logic",
      "lineNumbers": [
        27
      ],
      "severity": "major",
      "description": "Refresh token path uses age in hours, not days.",
      "localizedDescription": {
        "es": "La ruta del refresh token usa la edad en horas, no en d\u00edas."
      }
    }
  ],
  "importance": "high"
}
